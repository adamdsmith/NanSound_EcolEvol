---
output: 
  pdf_document:
fontsize: 12pt
geometry: margin=1in
number_sections: true
documentclass: article
---

```{r load, echo=FALSE, message=FALSE, warning=FALSE}
# Aliases and functions
devtools::source_gist(9216051) # Rprofile.R
devtools::source_gist(9216061) # various.R

require(dplyr); require(ggplot2); require(lubridate)

## load plotting function
source("../R/full_effect_plot.R")

## Get covariate means and SDs
source("../R/create_new_data.R")

## Load sea duck data and relevant models
source("../R/load_sea_duck_data.R")
load("C:/Users/Graduate_Student/Documents/Adam's_Stuff/NanSound/Results_scot/zero.rda")
#load("../Results_scot/zero.Rda")
SCOTocc <- zero

load("C:/Users/Graduate_Student/Documents/Adam's_Stuff/NanSound/Results_scot/hurdle.rda")
#load("../Results_scot/hurdle.Rda")
SCOTcc <- hurdle

## Set some graphic parameters
theme_set(theme_bw(base_size = 18))
theme_update(panel.grid.minor = element_blank(),
  panel.grid.major= element_blank(),
  panel.border=element_rect(fill=NA),
  panel.background= element_blank(),
  legend.position = 'none')

knitr::opts_chunk$set(message=FALSE, warning=FALSE, echo=FALSE,
                      fig.width=6.5, fig.height=6.5)
```

# Appendix 6. Scoter stable covariate effects

Marginal functional plots of the relationships between covariates (controlling for all other

variables; i.e., at their mean values) and the occupancy, conditional mean abundance, and 

conditional overdispersion of abundance of scoters (Black, Surf, and White-winged Scoter) in

Nantucket Sound, Massachusetts, USA.  Covariate plots are ordered roughly in descending 

order of the magnitude of their influence on the additive predictor in each model (or model 

parameter for count models).  Vertical lines along the *x*-axis (i.e., rug plots) indicate 

observed covariate values.  Covariates (and any abbreviations) are defined in detail in 

Appendix 2.

## Occupancy
```{r occ, out.extra=sprintf('angle=%d', c(90,rep(0, 9)))}
# xkm, ykm
full_effect_plot(SCOTocc, scot, "xkm, ykm", "st", xlab = "Easting (km from center)",
                 ylab = "Northing (km from center")

vars <- c("obs_window", "time", "SAR", "SSTm", "cdom", "SSTw", "meanphi", "d2land", "depth")
xlabs <- c(expression(Survey~effort~(transect~km^2)), "Days from 31 December", 
           "Sea floor surface area:planimetric area", 
           expression(paste(SST, ", ", monthly~average~(degree*C))), "Chromomorphic dissolved organic matter", 
           expression(paste(SST, ", ", Nov~-~Mar~(degree*C))),
           "Sediment grain size (phi)", "Distance to land (km)", 
           "Depth relative to mean sea level (m)")
types <- rep("uni", 9)

for (i in 1:length(vars)) {
  var <- vars[i]
  xlab <- xlabs[i]
  type <- types[i]
  print(full_effect_plot(SCOTocc, scot, var, type, xlab = xlab))
}
```

## Conditional mean
```{r mu, out.extra=sprintf('angle=%d', c(90,0,0,0,0))}
# xkm, ykm
full_effect_plot(SCOTcc, parameter = "mu", var = "xkm, ykm", varType = "st", 
                 xlab = "Easting (km from center)", ylab = "Northing (km from center")

vars <- c("SSTrel", "time", "d2land", "meanphi")
xlabs <- c(expression(paste(SST, ", ", relative~to~other~segments~(degree*C))),
            "Days from 31 December", "Distance to land (km)",
            "Sediment grain size (phi)")
types <- rep("uni", 4)
for (i in 1:length(vars)) {
  var <- vars[i]
  xlab <- xlabs[i]
  type <- types[i]
  print(full_effect_plot(SCOTcc, parameter = "mu", var = var, varType = type, xlab = xlab))
}
```

## Conditional overdispersion
```{r sigma}
vars <- c("meanphi", "tidesd", "SAR", "SSTrel", "y2004", "y2005")
xlabs <- c("Sediment grain size (phi)", "Epibenthic tidal velocity (standard deviation; m/s)",
            "Sea floor surface area:planimetric area", 
            expression(paste(SST, ", ", relative~to~other~segments~(degree*C))),
            "Winter (2004)", "Winter (2005)")
types <- c(rep("uni", 4), "fac", "fac")
for (i in 1:length(vars)) {
  var <- vars[i]
  xlab <- xlabs[i]
  type <- types[i]
  print(full_effect_plot(SCOTcc, parameter = "sigma", var = var, varType = type, xlab = xlab))
}
```
